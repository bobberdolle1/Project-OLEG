# Changelog

–í—Å–µ –∑–Ω–∞—á–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É—é—Ç—Å—è –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ.

–§–æ—Ä–º–∞—Ç –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
–ø—Ä–æ–µ–∫—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è [Semantic Versioning](https://semver.org/lang/ru/).

---

## [5.0.0] - 2025-12-05

### üöÄ –î–æ–±–∞–≤–ª–µ–Ω–æ

#### AI Core
- **Think Tag Filter** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ `<think>...</think>` —Ç–µ–≥–æ–≤
  - `app/services/think_filter.py` ‚Äî regex-—Ñ–∏–ª—å—Ç—Ä –¥–ª—è LLM –æ—Ç–≤–µ—Ç–æ–≤
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –∏ malformed —Ç–µ–≥–æ–≤
  - Fallback –ø—Ä–∏ –ø—É—Å—Ç–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ

- **2-Step Vision Pipeline** ‚Äî –µ–¥–∏–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  - `app/services/vision_pipeline.py` ‚Äî –¥–≤—É—Ö—ç—Ç–∞–ø–Ω—ã–π –∞–Ω–∞–ª–∏–∑
  - Step 1: Vision –º–æ–¥–µ–ª—å –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (—Å–∫—Ä—ã—Ç–æ)
  - Step 2: Oleg LLM –∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ—Ç –≤ —Å–≤–æ—ë–º —Å—Ç–∏–ª–µ
  - JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è pipeline

- **Context-Aware Persona** ‚Äî –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–º–ø—Ç
  - Shift –æ—Ç "hardware expert" –∫ "cynical IT generalist"
  - –û—Ç–≤–µ—Ç—ã –Ω–∞ –ª—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã –±–µ–∑ —Ñ–æ—Ä—Å–∏—Ä–æ–≤–∞–Ω–∏—è –∂–µ–ª–µ–∑–∞

#### Memory & Context
- **Cross-Topic Perception** ‚Äî –º–µ–∂-—Ç–æ–ø–∏–∫–æ–≤–æ–µ –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ
  - `app/handlers/topic_listener.py` ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Å–ª—É—à–∞—Ç–µ–ª—å
  - RAG —Ö—Ä–∞–Ω–∏—Ç chat_id –∏ topic_id –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
  - –ü–æ–∏—Å–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏–∑ –≤—Å–µ—Ö —Ç–æ–ø–∏–∫–æ–≤ —Å—É–ø–µ—Ä–≥—Ä—É–ø–ø—ã

#### Autonomy
- **Auto-Reply System** ‚Äî –≤–∫–ª–∏–Ω–∏–≤–∞–Ω–∏–µ –≤ —Ä–∞–∑–≥–æ–≤–æ—Ä
  - `app/services/auto_reply.py` ‚Äî —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ-–æ—Ç–≤–µ—Ç–æ–≤
  - –ë–∞–∑–æ–≤—ã–π —à–∞–Ω—Å 1-5%, –±—É—Å—Ç –∑–∞ CAPS LOCK –∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã
  - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è per-chat —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É

#### Admin UI
- **Owner Dashboard** ‚Äî –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –Ω–∞ inline-–∫–Ω–æ–ø–∫–∞—Ö
  - `app/handlers/admin_dashboard.py` ‚Äî –ø–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
  - Moderation: —Ä–µ–∂–∏–º, –∞–Ω—Ç–∏—Å–ø–∞–º, –±–∞–Ω
  - Behavior: –∞–≤—Ç–æ-–æ—Ç–≤–µ—Ç—ã, —Ç–æ–ø–∏–∫–∏
  - Actions: —Å–∞–º–º–∞—Ä–∏, –∏—Å—Ç–æ—Ä–∏–∏, —Ä–µ—Å—Ç–∞—Ä—Ç
  - Statistics: –≥—Ä–∞—Ñ–∏–∫–∏, —Ç–æ–∫—Å–∏–∫–∏, —Ç–æ–∫–µ–Ω—ã

#### Games
- **PvP with Consent** ‚Äî –≤—ã–∑–æ–≤—ã —Å —Å–æ–≥–ª–∞—Å–∏–µ–º
  - `app/services/game_engine.py` ‚Äî –¥–≤–∏–∂–æ–∫ –∏–≥—Ä
  - Challenge ‚Üí Accept/Decline ‚Üí Game
  - –¢–∞–π–º–∞—É—Ç –±–µ–∑ —Å–ø–∏—Å–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
  - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤

- **Russian Roulette** ‚Äî —Ä—É—Å—Å–∫–∞—è —Ä—É–ª–µ—Ç–∫–∞
  - 1/6 –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å "–≤—ã—Å—Ç—Ä–µ–ª–∞"
  - –®—Ç—Ä–∞—Ñ –∑–∞ –≤—ã—Å—Ç—Ä–µ–ª, –Ω–∞–≥—Ä–∞–¥–∞ –∑–∞ –≤—ã–∂–∏–≤–∞–Ω–∏–µ
  - Oleg-style —Å–æ–æ–±—â–µ–Ω–∏—è

- **Coin Flip** ‚Äî —Å—Ç–∞–≤–∫–∏ –Ω–∞ –º–æ–Ω–µ—Ç–∫—É
  - 50/50 –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å
  - –£–¥–≤–æ–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏ –ø—Ä–∏ –≤—ã–∏–≥—Ä—ã—à–µ
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞

#### Health & Monitoring
- **Enhanced /ping** ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
  - `app/handlers/health.py` ‚Äî —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –ø–æ–¥—Å–∏—Å—Ç–µ–º
  - Telegram latency, Ollama, Vision, RAG
  - –¶–≤–µ—Ç–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Å—Ç–∞—Ç—É—Å–∞

#### Media
- **Video Notes** ‚Äî —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∫—Ä—É–∂–æ—á–∫–æ–≤
  - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—É–¥–∏–æ —á–µ—Ä–µ–∑ ffmpeg
  - –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è —á–µ—Ä–µ–∑ Whisper

- **Media Download** ‚Äî –∞–≤—Ç–æ-—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ
  - `app/services/content_downloader.py` ‚Äî TikTok, Shorts, Reels
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ (<50MB)
  - Graceful error handling

#### Database
- **GameChallenge model** ‚Äî –≤—ã–∑–æ–≤—ã –Ω–∞ –∏–≥—Ä—ã
- **UserBalance model** ‚Äî –±–∞–ª–∞–Ω—Å –¥–ª—è –∏–≥—Ä
- **Alembic migration** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

#### Testing
- **Property-Based Testing** ‚Äî 46 —Ç–µ—Å—Ç–æ–≤ –Ω–∞ Hypothesis
  - `tests/property/` ‚Äî PBT —Ç–µ—Å—Ç—ã
  - Think Filter: 9 —Ç–µ—Å—Ç–æ–≤
  - Vision Pipeline: 7 —Ç–µ—Å—Ç–æ–≤
  - Auto-Reply: 9 —Ç–µ—Å—Ç–æ–≤
  - RAG: 5 —Ç–µ—Å—Ç–æ–≤
  - Game Engine: 16 —Ç–µ—Å—Ç–æ–≤

### üîß –ò–∑–º–µ–Ω–µ–Ω–æ

- **Vision handler** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π VisionPipeline
- **Ollama client** ‚Äî –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω ThinkTagFilter
- **RAG system** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ topic_id
- **Main router** ‚Äî –Ω–æ–≤—ã–µ handlers

---

## [4.5.0] - 2025-12-05

### üöÄ –î–æ–±–∞–≤–ª–µ–Ω–æ

#### –ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å
- **–ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** ‚Äî —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ —á–µ—Ä–µ–∑ Whisper
- **–í–∏–¥–µ–æ—Å–æ–æ–±—â–µ–Ω–∏—è (–∫—Ä—É–∂–æ—á–∫–∏)** ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –∞—É–¥–∏–æ
- **–£–ª—É—á—à–µ–Ω–Ω—ã–π Vision** ‚Äî –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç
- **–í–µ–±-–ø–æ–∏—Å–∫** ‚Äî –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —á–µ—Ä–µ–∑ DuckDuckGo
- **Anti-loop –∑–∞—â–∏—Ç–∞** ‚Äî –¥–µ—Ç–µ–∫—Ü–∏—è –∑–∞—Ü–∏–∫–ª–µ–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

### üìä –ú–µ—Ç—Ä–∏–∫–∏
- `bot_voice_transcriptions_total`
- `bot_video_notes_processed_total`
- `bot_vision_requests_total`

---

## [4.0.0] - 2024-12-05

### üöÄ –î–æ–±–∞–≤–ª–µ–Ω–æ

#### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **Redis** ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π rate limiting
- **PostgreSQL** ‚Äî production-ready –±–∞–∑–∞
- **Prometheus –º–µ—Ç—Ä–∏–∫–∏** ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **Grafana Dashboard** ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

#### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞
- **33 —Ç–µ—Å—Ç–∞** ‚Äî unit + integration
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è

---

## [3.0.0] - 2024-11-XX

### –î–æ–±–∞–≤–ª–µ–Ω–æ
- Vision –º–æ–¥–µ–ª—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- RAG –Ω–∞ ChromaDB
- –°–∏—Å—Ç–µ–º–∞ –≥–∏–ª—å–¥–∏–π
- –î—É–æ-—Ä–µ–∂–∏–º –¥–ª—è PvP

---

## [2.0.0] - 2024-10-XX

### –î–æ–±–∞–≤–ª–µ–Ω–æ
- Python 3.12+ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- Pydantic Settings
- Rate limiting
- Alembic –º–∏–≥—Ä–∞—Ü–∏–∏

### –ò–∑–º–µ–Ω–µ–Ω–æ
- –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ aiogram 3.x
- Async SQLAlchemy

---

## [1.0.0] - 2024-09-XX

### –î–æ–±–∞–≤–ª–µ–Ω–æ
- –ë–∞–∑–æ–≤—ã–π Q&A —Å Ollama
- –ò–≥—Ä–æ–≤—ã–µ –º–µ—Ö–∞–Ω–∏–∫–∏
- –ú–æ–¥–µ—Ä–∞—Ü–∏—è
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ —Å–∞–º–º–∞—Ä–∏

---

## –õ–µ–≥–µ–Ω–¥–∞

- üöÄ **–î–æ–±–∞–≤–ª–µ–Ω–æ** ‚Äî –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- üîß **–ò–∑–º–µ–Ω–µ–Ω–æ** ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö
- üêõ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤
- üóëÔ∏è **–£–¥–∞–ª–µ–Ω–æ** ‚Äî —É–¥–∞–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- üìä **–ú–µ—Ç—Ä–∏–∫–∏** ‚Äî –Ω–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
