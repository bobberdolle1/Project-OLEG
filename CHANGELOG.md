# Changelog

–í—Å–µ –∑–Ω–∞—á–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É—é—Ç—Å—è –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ.

–§–æ—Ä–º–∞—Ç –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
–ø—Ä–æ–µ–∫—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è [Semantic Versioning](https://semver.org/lang/ru/).

---

## [4.5.0] - 2025-12-05

### üöÄ –î–æ–±–∞–≤–ª–µ–Ω–æ

#### –ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å
- **–ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** ‚Äî —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ —á–µ—Ä–µ–∑ Whisper
  - `app/services/voice_recognition.py` ‚Äî —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –∞—É–¥–∏–æ
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–æ–¥–µ–ª–µ–π: tiny, base, small, medium, large
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è OGG ‚Üí WAV —á–µ—Ä–µ–∑ ffmpeg

- **–í–∏–¥–µ–æ—Å–æ–æ–±—â–µ–Ω–∏—è (–∫—Ä—É–∂–æ—á–∫–∏)** ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –∞—É–¥–∏–æ
  - –§—É–Ω–∫—Ü–∏—è `transcribe_video_note()` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ video_note
  - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—É–¥–∏–æ–¥–æ—Ä–æ–∂–∫–∏ —á–µ—Ä–µ–∑ ffmpeg
  - –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ –∫–∞–∫ –≤ –≥–æ–ª–æ—Å–æ–≤—ã—Ö

- **–£–ª—É—á—à–µ–Ω–Ω—ã–π Vision** ‚Äî –∞–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  - –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤
  - –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—É—Å—Ç—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –º–æ–¥–µ–ª–∏
  - –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

#### –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç
- **–í–µ–±-–ø–æ–∏—Å–∫** ‚Äî –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —á–µ—Ä–µ–∑ DuckDuckGo
  - `OLLAMA_WEB_SEARCH_ENABLED=true` –≤ –∫–æ–Ω—Ñ–∏–≥–µ
  - LLM —Å–∞–º —Ä–µ—à–∞–µ—Ç –∫–æ–≥–¥–∞ –∏—Å–∫–∞—Ç—å
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ Ollama Tools API

- **Anti-loop –∑–∞—â–∏—Ç–∞** ‚Äî –¥–µ—Ç–µ–∫—Ü–∏—è –∑–∞—Ü–∏–∫–ª–µ–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
  - –§—É–Ω–∫—Ü–∏—è `detect_loop_in_text()` –≤ ollama_client
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–µ–∑–∫–∞ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
  - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "[–û–ª–µ–≥ –∑–∞–≤–∏—Å, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–ª—Å—è]"

### üîß –ò–∑–º–µ–Ω–µ–Ω–æ

- **Vision handler** ‚Äî —É–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ base64
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª–µ–π –æ—Ç–≤–µ—Ç–∞
  - Graceful fallback –ø—Ä–∏ –ø—É—Å—Ç–æ–º –æ—Ç–≤–µ—Ç–µ

- **Voice handler** ‚Äî –æ–±–Ω–æ–≤–ª—ë–Ω –¥–ª—è –≤–∏–¥–µ–æ—Å–æ–æ–±—â–µ–Ω–∏–π
  - `handle_video_note()` —Ç–µ–ø–µ—Ä—å —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç —Ä–µ—á—å
  - –†–∞–Ω—å—à–µ –æ—Ç–≤–µ—á–∞–ª –æ—Ç–∫–∞–∑–æ–º, —Ç–µ–ø–µ—Ä—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä—É–µ—Ç

### üìä –ú–µ—Ç—Ä–∏–∫–∏

–ù–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
- `bot_voice_transcriptions_total` ‚Äî —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–µ –≥–æ–ª–æ—Å–æ–≤—ã–µ
- `bot_video_notes_processed_total` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∫—Ä—É–∂–æ—á–∫–∏
- `bot_vision_requests_total` ‚Äî –∑–∞–ø—Ä–æ—Å—ã –∫ Vision –º–æ–¥–µ–ª–∏
- `bot_web_searches_total` ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –≤–µ–±-–ø–æ–∏—Å–∫–∏

---

## [4.0.0] - 2024-12-05

### üöÄ –î–æ–±–∞–≤–ª–µ–Ω–æ

#### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **Redis** ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π rate limiting –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
  - `app/services/redis_client.py` ‚Äî async Redis –∫–ª–∏–µ–Ω—Ç
  - Graceful fallback –Ω–∞ in-memory –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

- **PostgreSQL** ‚Äî production-ready –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
  - –î—Ä–∞–π–≤–µ—Ä `asyncpg` –¥–ª—è async –æ–ø–µ—Ä–∞—Ü–∏–π

- **Prometheus –º–µ—Ç—Ä–∏–∫–∏** ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
  - `app/services/metrics.py` ‚Äî —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫
  - Endpoints: `/metrics`, `/health`, `/ready`

- **Grafana Dashboard** ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫
  - `monitoring/grafana/dashboards/oleg-bot.json`

#### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞
- **33 —Ç–µ—Å—Ç–∞** ‚Äî unit + integration –ø–æ–∫—Ä—ã—Ç–∏–µ
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è

### üîß –ò–∑–º–µ–Ω–µ–Ω–æ

- **Ollama Client** ‚Äî —É–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- **Rate Limiter** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Redis
- **Docker Compose** ‚Äî production-ready setup

---

## [3.0.0] - 2024-11-XX

### –î–æ–±–∞–≤–ª–µ–Ω–æ
- Vision –º–æ–¥–µ–ª—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- RAG –Ω–∞ ChromaDB –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–∞–º—è—Ç–∏
- –°–∏—Å—Ç–µ–º–∞ –≥–∏–ª—å–¥–∏–π –∏ –∫–æ–º–∞–Ω–¥–Ω—ã—Ö –≤–æ–π–Ω
- –î—É–æ-—Ä–µ–∂–∏–º –¥–ª—è PvP

---

## [2.0.0] - 2024-10-XX

### –î–æ–±–∞–≤–ª–µ–Ω–æ
- Python 3.12+ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- Pydantic Settings —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- Rate limiting
- Alembic –º–∏–≥—Ä–∞—Ü–∏–∏
- CI/CD pipeline

### –ò–∑–º–µ–Ω–µ–Ω–æ
- –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ aiogram 3.x
- Async SQLAlchemy

---

## [1.0.0] - 2024-09-XX

### –î–æ–±–∞–≤–ª–µ–Ω–æ
- –ë–∞–∑–æ–≤—ã–π Q&A —Å Ollama
- –ò–≥—Ä–æ–≤—ã–µ –º–µ—Ö–∞–Ω–∏–∫–∏ (grow, pvp, casino)
- –ú–æ–¥–µ—Ä–∞—Ü–∏—è (–±–∞–Ω, –º—É—Ç, –∫–∏–∫)
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ —Å–∞–º–º–∞—Ä–∏ —á–∞—Ç–∞
- –ê–Ω—Ç–∏—Å–ø–∞–º –∏ –∞–Ω—Ç–∏—Ä–µ–π–¥

---

## –õ–µ–≥–µ–Ω–¥–∞

- üöÄ **–î–æ–±–∞–≤–ª–µ–Ω–æ** ‚Äî –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- üîß **–ò–∑–º–µ–Ω–µ–Ω–æ** ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö
- üêõ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤
- üóëÔ∏è **–£–¥–∞–ª–µ–Ω–æ** ‚Äî —É–¥–∞–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- üìä **–ú–µ—Ç—Ä–∏–∫–∏** ‚Äî –Ω–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
