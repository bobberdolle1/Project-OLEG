# Changelog

–í—Å–µ –∑–Ω–∞—á–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É—é—Ç—Å—è –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ.

–§–æ—Ä–º–∞—Ç –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
–ø—Ä–æ–µ–∫—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è [Semantic Versioning](https://semver.org/lang/ru/).

---

## [4.0.0] - 2024-12-05

### üöÄ –î–æ–±–∞–≤–ª–µ–Ω–æ

#### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **Redis** ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π rate limiting –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
  - `app/services/redis_client.py` ‚Äî async Redis –∫–ª–∏–µ–Ω—Ç
  - Graceful fallback –Ω–∞ in-memory –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
  - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `.env`

- **PostgreSQL** ‚Äî production-ready –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
  - –î—Ä–∞–π–≤–µ—Ä `asyncpg` –¥–ª—è async –æ–ø–µ—Ä–∞—Ü–∏–π
  - –ì–æ—Ç–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å –≤ `docker-compose.yml`

- **Prometheus –º–µ—Ç—Ä–∏–∫–∏** ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
  - `app/services/metrics.py` ‚Äî —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫
  - `app/services/metrics_server.py` ‚Äî HTTP —Å–µ—Ä–≤–µ—Ä
  - Endpoints: `/metrics`, `/health`, `/ready`

- **Grafana Dashboard** ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫
  - `monitoring/grafana/dashboards/oleg-bot.json`
  - –ü–∞–Ω–µ–ª–∏: —Å–æ–æ–±—â–µ–Ω–∏—è, –æ—à–∏–±–∫–∏, Ollama latency, rate limits

#### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞
- **33 —Ç–µ—Å—Ç–∞** ‚Äî unit + integration –ø–æ–∫—Ä—ã—Ç–∏–µ
  - `test_rate_limiter.py` ‚Äî rate limiting –ª–æ–≥–∏–∫–∞
  - `test_redis_client.py` ‚Äî Redis –æ–ø–µ—Ä–∞—Ü–∏–∏
  - `test_config.py` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
  - `test_metrics.py` ‚Äî —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫
  - `test_ollama_fallback.py` ‚Äî graceful degradation
  - `test_database.py` ‚Äî –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î

- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
  - –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π `README.md`
  - `TESTING.md` ‚Äî —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
  - –û–±–Ω–æ–≤–ª–µ–Ω—ã `.env.example`, `.env.docker`

### üîß –ò–∑–º–µ–Ω–µ–Ω–æ

- **Ollama Client** ‚Äî —É–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
  - –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è timeout, HTTP error, connection error
  - Graceful degradation ‚Äî –±–æ—Ç –Ω–µ –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å LLM
  - –ú–µ—Ç—Ä–∏–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞

- **Rate Limiter** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Redis
  - –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π rate limiting –¥–ª—è multi-instance
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –Ω–∞ in-memory
  - –¢—Ä–µ–∫–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫

- **Docker Compose** ‚Äî production-ready setup
  - –î–æ–±–∞–≤–ª–µ–Ω Redis —Å–µ—Ä–≤–∏—Å
  - Health checks –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
  - –ü–æ—Ä—Ç 9090 –¥–ª—è –º–µ—Ç—Ä–∏–∫
  - –ì–æ—Ç–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã Prometheus/Grafana (–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã)

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ `utc_now()`** ‚Äî —É–¥–∞–ª–µ–Ω–∞ –¥—É–±–ª–∏—Ä—É—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–∑ `models.py`
- **–ò–º–ø–æ—Ä—Ç—ã** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### üìä –ú–µ—Ç—Ä–∏–∫–∏

–ù–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
- `bot_messages_processed_total{chat_type}` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- `bot_commands_executed_total{command}` ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
- `bot_ollama_requests_total{model,success}` ‚Äî –∑–∞–ø—Ä–æ—Å—ã –∫ Ollama
- `bot_ollama_request_duration_seconds{model}` ‚Äî –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
- `bot_rate_limit_hits_total` ‚Äî —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è rate limit
- `bot_errors_total{type}` ‚Äî –æ—à–∏–±–∫–∏ –ø–æ —Ç–∏–ø–∞–º
- `bot_active_users` ‚Äî –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `bot_cache_size` ‚Äî —Ä–∞–∑–º–µ—Ä –∫—ç—à–∞

---

## [3.0.0] - 2024-11-XX

### –î–æ–±–∞–≤–ª–µ–Ω–æ
- Vision –º–æ–¥–µ–ª—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- RAG –Ω–∞ ChromaDB –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–∞–º—è—Ç–∏
- –°–∏—Å—Ç–µ–º–∞ –≥–∏–ª—å–¥–∏–π –∏ –∫–æ–º–∞–Ω–¥–Ω—ã—Ö –≤–æ–π–Ω
- –î—É–æ-—Ä–µ–∂–∏–º –¥–ª—è PvP
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

---

## [2.0.0] - 2024-10-XX

### –î–æ–±–∞–≤–ª–µ–Ω–æ
- Python 3.12+ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- Pydantic Settings —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- Rate limiting –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Å–ø–∞–º–∞
- Alembic –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
- CI/CD pipeline (GitHub Actions)
- Pre-commit hooks
- Production-ready Docker setup

### –ò–∑–º–µ–Ω–µ–Ω–æ
- –ü–æ–ª–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã
- –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ aiogram 3.x
- Async SQLAlchemy

---

## [1.0.0] - 2024-09-XX

### –î–æ–±–∞–≤–ª–µ–Ω–æ
- –ë–∞–∑–æ–≤—ã–π Q&A —Å Ollama
- –ò–≥—Ä–æ–≤—ã–µ –º–µ—Ö–∞–Ω–∏–∫–∏ (grow, pvp, casino)
- –ú–æ–¥–µ—Ä–∞—Ü–∏—è (–±–∞–Ω, –º—É—Ç, –∫–∏–∫)
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ —Å–∞–º–º–∞—Ä–∏ —á–∞—Ç–∞
- –ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç (—Ü–∏—Ç–∞—Ç—ã, –∏—Å—Ç–æ—Ä–∏–∏)
- –ê–Ω—Ç–∏—Å–ø–∞–º –∏ –∞–Ω—Ç–∏—Ä–µ–π–¥
- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –≤ –õ–°

---

## –õ–µ–≥–µ–Ω–¥–∞

- üöÄ **–î–æ–±–∞–≤–ª–µ–Ω–æ** ‚Äî –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- üîß **–ò–∑–º–µ–Ω–µ–Ω–æ** ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö
- üêõ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤
- üóëÔ∏è **–£–¥–∞–ª–µ–Ω–æ** ‚Äî —É–¥–∞–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- üìä **–ú–µ—Ç—Ä–∏–∫–∏** ‚Äî –Ω–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
