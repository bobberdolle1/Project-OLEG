"""Help command handler."""

import logging
from aiogram import Router
from aiogram.filters import Command
from aiogram.types import Message, CallbackQuery
from aiogram.utils.keyboard import InlineKeyboardBuilder

logger = logging.getLogger(__name__)

router = Router()


# ============================================================================
# –¢–µ–∫—Å—Ç—ã —Ä–∞–∑–¥–µ–ª–æ–≤ –ø–æ–º–æ—â–∏
# ============================================================================

HELP_INTRO = """
ü§ñ <b>–û–ª–µ–≥ ‚Äî –¢–≤–æ–π —Ü–∏—Ñ—Ä–æ–≤–æ–π –≥–∏–≥–∞—á–∞–¥</b>

–Ø –º–Ω–æ–≥–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –±–æ—Ç —Å –ò–ò, –∏–≥—Ä–∞–º–∏, –º–æ–¥–µ—Ä–∞—Ü–∏–µ–π –∏ –∫—É—á–µ–π —Ñ–∏—á.

–í—ã–±–µ—Ä–∏ —Ä–∞–∑–¥–µ–ª, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ:
"""

HELP_FEATURES = """
üß† <b>–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –û–ª–µ–≥–∞</b>

<b>ü§ñ –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç:</b>
‚Ä¢ –û—Ç–≤–µ—á–∞—é –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã (—É–ø–æ–º—è–Ω–∏ –º–µ–Ω—è –∏–ª–∏ –æ—Ç–≤–µ—Ç—å –Ω–∞ –º–æ—ë —Å–æ–æ–±—â–µ–Ω–∏–µ)
‚Ä¢ –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è ‚Äî –æ—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ —Å –≤–æ–ø—Ä–æ—Å–æ–º
‚Ä¢ –†–∞—Å–ø–æ–∑–Ω–∞—é –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –æ—Ç–≤–µ—á–∞—é –Ω–∞ –Ω–∏—Ö
‚Ä¢ –ò—â—É –∞–∫—Ç—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ

<b>üì• –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏:</b>
‚Ä¢ –°–∫–∞—á–∏–≤–∞—é –≤–∏–¥–µ–æ/–∞—É–¥–∏–æ –ø–æ —Å—Å—ã–ª–∫–∞–º (YouTube, TikTok, VK, Instagram)
‚Ä¢ –î–µ–ª–∞—é –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –ø–µ—Ä–µ—Å–∫–∞–∑ —á–∞—Ç–∞ (08:00 –ú–°–ö)
‚Ä¢ –ì–µ–Ω–µ—Ä–∏—Ä—É—é –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç (20:00 –ú–°–ö)
‚Ä¢ –°–ª—É—á–∞–π–Ω–æ –∫–æ–º–º–µ–Ω—Ç–∏—Ä—É—é —Å–æ–æ–±—â–µ–Ω–∏—è (—è –∂–µ –∂–∏–≤–æ–π!)

<b>üõ° –ó–∞—â–∏—Ç–∞ —á–∞—Ç–∞:</b>
‚Ä¢ –ê–Ω—Ç–∏—Ä–∞–∏–¥ ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç –º–∞—Å—Å–æ–≤–æ–≥–æ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –±–æ—Ç–æ–≤
‚Ä¢ –ê–Ω–∞–ª–∏–∑ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
‚Ä¢ –°–ø–∞–º-—Ñ–∏–ª—å—Ç—Ä —Å —É–º–Ω—ã–º–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏
‚Ä¢ –†–µ–∂–∏–º—ã –º–æ–¥–µ—Ä–∞—Ü–∏–∏ (light/normal/dictatorship)

<b>üé§ –ì–æ–ª–æ—Å:</b>
‚Ä¢ /say [—Ç–µ–∫—Å—Ç] ‚Äî –æ–∑–≤—É—á—É —Ç–µ–∫—Å—Ç –≥–æ–ª–æ—Å–æ–º
‚Ä¢ –†–∞—Å–ø–æ–∑–Ω–∞—é –≥–æ–ª–æ—Å–æ–≤—ã–µ –∏ –æ—Ç–≤–µ—á–∞—é –Ω–∞ –Ω–∏—Ö

<b>üìù –ö–æ–Ω—Ç–µ–Ω—Ç:</b>
‚Ä¢ /tldr ‚Äî –ø–µ—Ä–µ—Å–∫–∞–∑ –ø–æ —Å—Å—ã–ª–∫–µ –∏–ª–∏ —Ä–µ–ø–ª–∞—é
‚Ä¢ /q ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ü–∏—Ç–∞—Ç—É (—Ä–µ–ø–ª–∞–π –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ)
‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –º–µ–¥–∏–∞ –ø–æ —Å—Å—ã–ª–∫–∞–º
"""

HELP_GAMES = """
üéÆ <b>–ò–≥—Ä—ã –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</b>

<b>üìä –û—Å–Ω–æ–≤–Ω–æ–µ:</b>
/games ‚Äî <b>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≥–∞–π–¥ –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤!</b>
/profile ‚Äî –¢–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
/top ‚Äî –¢–æ–ø-10 –ø–æ —Ä–∞–∑–º–µ—Ä—É
/top_rep ‚Äî –¢–æ–ø-10 –ø–æ —Ä–µ–ø—É—Ç–∞—Ü–∏–∏

<b>üé∞ –ú–∏–Ω–∏-–∏–≥—Ä—ã:</b>
/grow ‚Äî –£–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä (–∫—É–ª–¥–∞—É–Ω 12-24—á)
/pvp @user ‚Äî –î—É—ç–ª—å —Å –∏–≥—Ä–æ–∫–æ–º
/casino [—Å—Ç–∞–≤–∫–∞] ‚Äî –°–ª–æ—Ç—ã (–º–∏–Ω. 10 –º–æ–Ω–µ—Ç)
/roulette [—Å—Ç–∞–≤–∫–∞] [–≤—ã–±–æ—Ä] ‚Äî –†—É–ª–µ—Ç–∫–∞
/coinflip [—Å—Ç–∞–≤–∫–∞] ‚Äî –ü–æ–¥–±—Ä–æ—Å—å –º–æ–Ω–µ—Ç–∫—É
/blackjack [—Å—Ç–∞–≤–∫–∞] ‚Äî –ë–ª—ç–∫–¥–∂–µ–∫ (21)

<b>üè∞ –ì–∏–ª—å–¥–∏–∏:</b>
/create_guild [–∏–º—è] ‚Äî –°–æ–∑–¥–∞—Ç—å –≥–∏–ª—å–¥–∏—é
/join_guild [–∏–º—è] ‚Äî –í—Å—Ç—É–ø–∏—Ç—å
/leave_guild ‚Äî –ü–æ–∫–∏–Ω—É—Ç—å
/guild_info ‚Äî –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥–∏–ª—å–¥–∏–∏
/guild_war @–≥–∏–ª—å–¥–∏—è ‚Äî –û–±—ä—è–≤–∏—Ç—å –≤–æ–π–Ω—É

<b>üë• –î—É—ç—Ç—ã:</b>
/create_duo @–ø–∞—Ä—Ç–Ω–µ—Ä ‚Äî –°–æ–∑–¥–∞—Ç—å –¥—É—ç—Ç
/duo_stats ‚Äî –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥—É—ç—Ç–∞
/duo_pvp @–¥—É—ç—Ç ‚Äî –î—É—ç–ª—å –¥—É—ç—Ç–æ–≤
/top_duos ‚Äî –¢–æ–ø –¥—É—ç—Ç–æ–≤

<b>üèÜ –¢—É—Ä–Ω–∏—Ä—ã:</b>
/tournament ‚Äî –¢–µ–∫—É—â–∏–π —Ç—É—Ä–Ω–∏—Ä
/tournament_daily ‚Äî –î–Ω–µ–≤–Ω–æ–π —Ä–µ–π—Ç–∏–Ω–≥
/tournament_weekly ‚Äî –ù–µ–¥–µ–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥

<b>üéØ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ –∫–≤–µ—Å—Ç—ã:</b>
/achievements ‚Äî –í—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
/my_achievements ‚Äî –¢–≤–æ–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
/quests ‚Äî –ê–∫—Ç–∏–≤–Ω—ã–µ –∫–≤–µ—Å—Ç—ã
/quest_progress ‚Äî –ü—Ä–æ–≥—Ä–µ—Å—Å
"""

HELP_MODERATION = """
üõ° <b>–ú–æ–¥–µ—Ä–∞—Ü–∏—è (–¥–ª—è –∞–¥–º–∏–Ω–æ–≤)</b>

<b>–ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>
–æ–ª–µ–≥ –±–∞–Ω @user [–≤—Ä–µ–º—è] [–ø—Ä–∏—á–∏–Ω–∞]
–æ–ª–µ–≥ –º—É—Ç @user [–≤—Ä–µ–º—è] [–ø—Ä–∏—á–∏–Ω–∞]
–æ–ª–µ–≥ –∫–∏–∫ @user [–ø—Ä–∏—á–∏–Ω–∞]
–æ–ª–µ–≥ —Ä–µ–∂–∏–º [light|normal|dictatorship]

<b>–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:</b>
/warn ‚Äî –í—ã–¥–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ (—Ä–µ–ø–ª–∞–π)
/unwarn ‚Äî –°–Ω—è—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
/strikes @user ‚Äî –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç—Ä–∞–π–∫–∏

<b>–†–µ–∂–∏–º—ã –º–æ–¥–µ—Ä–∞—Ü–∏–∏:</b>
‚Ä¢ <b>light</b> ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –º–æ–¥–µ—Ä–∞—Ü–∏—è
‚Ä¢ <b>normal</b> ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–µ–∂–∏–º
‚Ä¢ <b>dictatorship</b> ‚Äî —Å—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º

<b>–ù–∞—Å—Ç—Ä–æ–π–∫–∞:</b>
/admin ‚Äî –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –≤ –õ–°
/—Å–æ–≤–µ—Ç—ã –∏–ª–∏ /tips ‚Äî –°–æ–≤–µ—Ç—ã –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é —á–∞—Ç–æ–º

<b>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞:</b>
‚Ä¢ –ê–Ω—Ç–∏—Ä–∞–∏–¥ (–∞–≤—Ç–æ-–±–∞–Ω –ø—Ä–∏ –º–∞—Å—Å–æ–≤–æ–º –≤—Å—Ç—É–ø–ª–µ–Ω–∏–∏)
‚Ä¢ –ê–Ω–∞–ª–∏–∑ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏
‚Ä¢ –°–ø–∞–º-—Ñ–∏–ª—å—Ç—Ä
‚Ä¢ GIF-–ø–∞—Ç—Ä—É–ª—å (NSFW –¥–µ—Ç–µ–∫—Ü–∏—è)
"""

HELP_QUOTES = """
üí¨ <b>–¶–∏—Ç–∞—Ç—ã</b>

<b>–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:</b>
/q ‚Äî –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ü–∏—Ç–∞—Ç—É (—Ä–µ–ø–ª–∞–π –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ)
/qs [—Ç–µ–≥] ‚Äî –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å —Ç–µ–≥–æ–º

<b>–ü—Ä–æ—Å–º–æ—Ç—Ä:</b>
/q [—Ç–µ–≥] ‚Äî –°–ª—É—á–∞–π–Ω–∞—è —Ü–∏—Ç–∞—Ç–∞ –ø–æ —Ç–µ–≥—É
/q @user ‚Äî –¶–∏—Ç–∞—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

<b>–£–¥–∞–ª–µ–Ω–∏–µ:</b>
/qd [id] ‚Äî –£–¥–∞–ª–∏—Ç—å —Ü–∏—Ç–∞—Ç—É (—Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä/–∞–¥–º–∏–Ω)

<b>–†–µ–∞–∫—Ü–∏–∏:</b>
–°—Ç–∞–≤—å üëç/üëé –Ω–∞ —Ü–∏—Ç–∞—Ç—ã –¥–ª—è —Ä–µ–π—Ç–∏–Ω–≥–∞!
"""

HELP_ADMIN = """
‚öôÔ∏è <b>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º</b>

<b>–í –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö:</b>
/admin ‚Äî –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —Ç–≤–æ–∏—Ö —á–∞—Ç–æ–≤
/owner ‚Äî –ü–∞–Ω–µ–ª—å –≤–ª–∞–¥–µ–ª—å—Ü–∞ (—Ç–æ–ª—å–∫–æ OWNER_ID)

<b>–ß—Ç–æ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:</b>
‚Ä¢ –†–µ–∂–∏–º—ã –º–æ–¥–µ—Ä–∞—Ü–∏–∏
‚Ä¢ –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π
‚Ä¢ –ê–Ω—Ç–∏—Ä–∞–∏–¥ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
‚Ä¢ –†–∞—Å—Å—ã–ª–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
‚Ä¢ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

<b>–°–±—Ä–æ—Å:</b>
/reset ‚Äî –°–±—Ä–æ—Å–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–∏–∞–ª–æ–≥–∞
/myhistory ‚Äî –ò—Å—Ç–æ—Ä–∏—è —Ç–≤–æ–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤

<b>–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:</b>
/ping ‚Äî –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞
/stats ‚Äî –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–∞—Ç–∞
"""

HELP_PRIVATE = """
ü§ñ <b>–û–ª–µ–≥ –≤ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö</b>

<b>üí¨ –û–±—â–µ–Ω–∏–µ:</b>
–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏ –º–Ω–µ ‚Äî —è –æ—Ç–≤–µ—á—É!
–û—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ ‚Äî –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É—é –µ–≥–æ.
–û—Ç–ø—Ä–∞–≤—å –≥–æ–ª–æ—Å–æ–≤–æ–µ ‚Äî —Ä–∞—Å–ø–æ–∑–Ω–∞—é –∏ –æ—Ç–≤–µ—á—É.

<b>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</b>
/admin ‚Äî –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —Ç–≤–æ–∏—Ö —á–∞—Ç–æ–≤
/owner ‚Äî –ü–∞–Ω–µ–ª—å –≤–ª–∞–¥–µ–ª—å—Ü–∞ –±–æ—Ç–∞
/reset ‚Äî –°–±—Ä–æ—Å–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–∏–∞–ª–æ–≥–∞
/myhistory ‚Äî –ò—Å—Ç–æ—Ä–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤

<b>üîä –ì–æ–ª–æ—Å:</b>
/say [—Ç–µ–∫—Å—Ç] ‚Äî –û–∑–≤—É—á—É —Ç–µ–∫—Å—Ç

<b>üìñ –°–ø—Ä–∞–≤–∫–∞:</b>
/help ‚Äî –≠—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞

<i>–í –ª–∏—á–∫–µ —è –¥–æ–±—Ä–µ–µ. –ù–æ –≤—Å—ë –µ—â—ë –≥–∏–≥–∞—á–∞–¥.</i>
"""


# ============================================================================
# –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã
# ============================================================================

def build_help_menu(is_private: bool = False) -> InlineKeyboardBuilder:
    """–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –ø–æ–º–æ—â–∏."""
    kb = InlineKeyboardBuilder()
    
    if is_private:
        kb.button(text="üß† –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏", callback_data="help_features")
        kb.button(text="‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ", callback_data="help_admin")
        kb.adjust(2)
    else:
        kb.button(text="üß† –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏", callback_data="help_features")
        kb.button(text="üéÆ –ò–≥—Ä—ã", callback_data="help_games")
        kb.button(text="üõ° –ú–æ–¥–µ—Ä–∞—Ü–∏—è", callback_data="help_moderation")
        kb.button(text="üí¨ –¶–∏—Ç–∞—Ç—ã", callback_data="help_quotes")
        kb.button(text="‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ", callback_data="help_admin")
        kb.adjust(2, 2, 1)
    
    return kb


def build_back_button() -> InlineKeyboardBuilder:
    """–ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥."""
    kb = InlineKeyboardBuilder()
    kb.button(text="üîô –ù–∞–∑–∞–¥", callback_data="help_main")
    return kb


# ============================================================================
# –•–µ–Ω–¥–ª–µ—Ä—ã
# ============================================================================

@router.message(Command("help"))
async def cmd_help(msg: Message):
    """–ö–æ–º–∞–Ω–¥–∞ /help ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É."""
    is_private = msg.chat.type == "private"
    
    if is_private:
        # –í –õ–° –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —É–ø—Ä–æ—â—ë–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é
        await msg.reply(HELP_PRIVATE, parse_mode="HTML")
    else:
        # –í –≥—Ä—É–ø–ø–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é
        kb = build_help_menu(is_private=False)
        await msg.reply(HELP_INTRO, reply_markup=kb.as_markup(), parse_mode="HTML")
    
    logger.info(f"Help requested by @{msg.from_user.username or msg.from_user.id} in {msg.chat.type} chat")


@router.callback_query(lambda c: c.data and c.data.startswith("help_"))
async def cb_help_section(callback: CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º –ø–æ–º–æ—â–∏."""
    section = callback.data.replace("help_", "")
    
    texts = {
        "main": HELP_INTRO,
        "features": HELP_FEATURES,
        "games": HELP_GAMES,
        "moderation": HELP_MODERATION,
        "quotes": HELP_QUOTES,
        "admin": HELP_ADMIN,
    }
    
    text = texts.get(section, HELP_INTRO)
    
    if section == "main":
        kb = build_help_menu(is_private=callback.message.chat.type == "private")
    else:
        kb = build_back_button()
    
    try:
        await callback.message.edit_text(text, reply_markup=kb.as_markup(), parse_mode="HTML")
    except Exception:
        pass  # –¢–µ–∫—Å—Ç –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è
    
    await callback.answer()
