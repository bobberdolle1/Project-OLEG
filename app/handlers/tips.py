"""Tips command handler for chat owners.

Provides actionable recommendations for improving chat management.
"""

import logging
from aiogram import Router
from aiogram.filters import Command
from aiogram.types import Message

logger = logging.getLogger(__name__)

router = Router()

# –ì–æ—Ç–æ–≤—ã–µ —Å–æ–≤–µ—Ç—ã –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
TIPS = [
    "üí° –ò—Å–ø–æ–ª—å–∑—É–π /—Ä–µ–∂–∏–º –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç—Ä–æ–≥–æ—Å—Ç–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ (light/normal/dictatorship)",
    "üí° –ö–æ–º–∞–Ω–¥–∞ /admin –≤ –õ–° –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–∞—Ç–æ–º",
    "üí° –í–∫–ª—é—á–∏ GIF-–ø–∞—Ç—Ä—É–ª—å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ GIF –Ω–∞ NSFW –∫–æ–Ω—Ç–µ–Ω—Ç",
    "üí° –ù–∞—Å—Ç—Ä–æ–π –∞–Ω—Ç–∏—Ä–µ–π–¥ —á–µ—Ä–µ–∑ /admin ‚Äî –æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–∞–Ω–∏—Ç –ø—Ä–∏ –º–∞—Å—Å–æ–≤–æ–º –≤—Å—Ç—É–ø–ª–µ–Ω–∏–∏",
    "üí° –ò—Å–ø–æ–ª—å–∑—É–π /warn –≤–º–µ—Å—Ç–æ —Å—Ä–∞–∑—É /ban ‚Äî —Å–∏—Å—Ç–µ–º–∞ —Å—Ç—Ä–∞–π–∫–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏",
    "üí° –ë–æ—Ç –º–æ–∂–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π ‚Äî –≤–∫–ª—é—á–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö",
    "üí° –ö–æ–º–∞–Ω–¥–∞ /whois –ø–æ–∫–∞–∂–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏ –µ–≥–æ –∏—Å—Ç–æ—Ä–∏—é",
    "üí° –ù–∞—Å—Ç—Ä–æ–π –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç—ã –±–æ—Ç–∞ —á–µ—Ä–µ–∑ /owner –ø–∞–Ω–µ–ª—å (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ –±–æ—Ç–∞)",
    "üí° –ë–æ—Ç —É–º–µ–µ—Ç –ø–µ—Ä–µ—Å–∫–∞–∑—ã–≤–∞—Ç—å –¥–ª–∏–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π /tldr",
    "üí° –¶–∏—Ç–∞—Ç—ã (/q) —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–∞–∫ —Å—Ç–∏–∫–µ—Ä—ã ‚Äî –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ —Å—Ç–∏–∫–µ—Ä–ø–∞–∫",
]


@router.message(Command("—Å–æ–≤–µ—Ç—ã", "tips"))
async def cmd_tips(msg: Message):
    """–°–æ–≤–µ—Ç—ã –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ —á–∞—Ç–∞."""
    # –¢–æ–ª—å–∫–æ –≤ –≥—Ä—É–ø–ø–∞—Ö
    if msg.chat.type == "private":
        await msg.reply(
            "üí° –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–∞—Ö.\n"
            "–ò—Å–ø–æ–ª—å–∑—É–π –µ—ë –≤ —á–∞—Ç–µ, –∫–æ—Ç–æ—Ä—ã–º —É–ø—Ä–∞–≤–ª—è–µ—à—å."
        )
        return
    
    user_id = msg.from_user.id
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∞
    try:
        member = await msg.chat.get_member(user_id)
        if member.status not in ("creator", "administrator"):
            await msg.reply("‚õî –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º —á–∞—Ç–∞.")
            return
    except Exception as e:
        logger.warning(f"Failed to check admin status: {e}")
        await msg.reply("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞.")
        return
    
    import random
    selected_tips = random.sample(TIPS, min(5, len(TIPS)))
    
    text = "üìã <b>–°–æ–≤–µ—Ç—ã –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é —á–∞—Ç–æ–º:</b>\n\n"
    text += "\n\n".join(selected_tips)
    text += "\n\n<i>–ò—Å–ø–æ–ª—å–∑—É–π /admin –≤ –õ–° –¥–ª—è –ø–æ–ª–Ω–æ–π –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</i>"
    
    await msg.reply(text, parse_mode="HTML")
